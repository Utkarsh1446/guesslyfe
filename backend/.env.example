# ==============================================================================
# GuessLyfe Backend Environment Configuration Template
# ==============================================================================
#
# This file contains all environment variables required for the backend.
# Copy this file to .env and fill in the actual values.
#
# DO NOT commit .env to version control!
#
# ==============================================================================

# ------------------------------------------------------------------------------
# Application Configuration
# ------------------------------------------------------------------------------

# Node environment (development, production, test, staging)
NODE_ENV=development

# Application version (semantic versioning)
APP_VERSION=1.0.0

# Server port
PORT=3000

# API base path (e.g., /api/v1)
API_PREFIX=api/v1

# Application name (used in logging, monitoring)
APP_NAME=guesslyfe-backend

# Allowed origins for CORS (comma-separated)
# Use * for development, specific domains for production
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# CORS credentials
CORS_CREDENTIALS=true

# Frontend URL (for email links, redirects)
FRONTEND_URL=http://localhost:3001

# Admin dashboard URL (optional)
ADMIN_DASHBOARD_URL=

# ------------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# ------------------------------------------------------------------------------

# Database host
DB_HOST=localhost

# Database port
DB_PORT=5432

# Database name
DB_DATABASE=guessly

# Database username
DB_USERNAME=postgres

# Database password
DB_PASSWORD=postgres

# Database connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10

# Enable database query logging (true/false)
DB_LOGGING=true

# Auto-synchronize schema (ONLY for development! Never use in production)
DB_SYNCHRONIZE=false

# Database SSL mode (disable, require, verify-ca, verify-full)
# Use 'disable' for local development, 'require' for production
DB_SSL_MODE=disable

# For production Cloud SQL connection
# DB_HOST=/cloudsql/PROJECT_ID:REGION:INSTANCE_NAME
# DB_SSL_MODE=require

# Log SQL queries
LOG_QUERIES=false

# ------------------------------------------------------------------------------
# Redis Configuration (Caching & Sessions)
# ------------------------------------------------------------------------------

# Redis host
REDIS_HOST=localhost

# Redis port
REDIS_PORT=6379

# Redis password (leave empty if no password)
REDIS_PASSWORD=

# Redis database number (0-15)
REDIS_DB=0

# Redis connection timeout (milliseconds)
REDIS_TIMEOUT=5000

# Redis key prefix (to avoid conflicts)
REDIS_PREFIX=guesslyfe:

# Redis TTL for cache (seconds, 3600 = 1 hour)
REDIS_CACHE_TTL=3600

# For production Memorystore connection
# REDIS_HOST=10.x.x.x
# REDIS_PASSWORD=your-redis-password

# ------------------------------------------------------------------------------
# Bull Queue Configuration (Background Jobs)
# ------------------------------------------------------------------------------

# Bull queue Redis host
BULL_REDIS_HOST=localhost

# Bull queue Redis port
BULL_REDIS_PORT=6379

# Bull queue Redis DB (separate from main Redis DB)
BULL_REDIS_DB=1

# Bull queue Redis password
BULL_REDIS_PASSWORD=

# Queue concurrency settings
QUEUE_NOTIFICATION_CONCURRENCY=5
QUEUE_BLOCKCHAIN_CONCURRENCY=3
QUEUE_EMAIL_CONCURRENCY=5

# Queue retry settings
QUEUE_MAX_RETRY_ATTEMPTS=3
QUEUE_RETRY_BACKOFF_MS=5000

# Enable queue monitoring UI (Bull Board)
QUEUE_MONITOR_ENABLED=true
QUEUE_MONITOR_PATH=/admin/queues

# ------------------------------------------------------------------------------
# JWT Authentication
# ------------------------------------------------------------------------------

# JWT secret key (MUST be long and random in production!)
# Generate with: openssl rand -base64 64
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# JWT access token expiration (e.g., 15m, 1h, 7d)
JWT_EXPIRATION=7d

# JWT refresh token secret
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production

# JWT refresh token expiration
JWT_REFRESH_EXPIRATION=30d

# JWT issuer (your domain)
JWT_ISSUER=guesslyfe.com

# JWT audience (your app)
JWT_AUDIENCE=guesslyfe-api

# ------------------------------------------------------------------------------
# Blockchain Configuration (Base Chain)
# ------------------------------------------------------------------------------

# Blockchain network (baseSepolia, baseMainnet)
BLOCKCHAIN_NETWORK=baseSepolia

# Blockchain RPC URL (Alchemy, Infura, QuickNode, or public)
# Get Alchemy API key from: https://www.alchemy.com/
BLOCKCHAIN_RPC_URL=https://sepolia.base.org

# Alternative RPC URL (fallback)
BLOCKCHAIN_RPC_URL_FALLBACK=

# Chain ID (84532 for Base Sepolia, 8453 for Base Mainnet)
BLOCKCHAIN_CHAIN_ID=84532

# RPC request timeout (milliseconds)
BLOCKCHAIN_RPC_TIMEOUT=30000

# Private key for contract interactions (without 0x prefix)
# WARNING: Keep this secret! Never commit to git!
BLOCKCHAIN_PROVIDER_PRIVATE_KEY=

# Gas settings
BLOCKCHAIN_GAS_LIMIT=500000
BLOCKCHAIN_GAS_PRICE_MULTIPLIER=1.1

# Block confirmation requirement
BLOCKCHAIN_CONFIRMATIONS=1

# Enable blockchain monitoring/indexing
BLOCKCHAIN_INDEXING_ENABLED=true

# Starting block for indexing (0 for genesis)
BLOCKCHAIN_INDEXING_START_BLOCK=0

# ------------------------------------------------------------------------------
# Smart Contract Addresses (Base Sepolia)
# Deployed: 2025-11-16 with Virtual Liquidity Bootstrapping
# ------------------------------------------------------------------------------

# USDC Token Contract
CONTRACT_USDC=0x036CbD53842c5426634e7929541eC2318f3dCF7e

# Fee Collector Contract
CONTRACT_FEE_COLLECTOR=0x9E0e83E0569d42a3A0420F68fe4D967F4C10F423

# Creator Share Factory Contract
CONTRACT_CREATOR_SHARE_FACTORY=0xaE86eC369E33A74769Ef7A1609b76E84B417c5Db

# Opinion Market Contract
CONTRACT_OPINION_MARKET=0x9cC5bBBceb80bE28f9be3F7dd69dC815Ba64099C

# Opinion Market Factory (if applicable)
CONTRACT_OPINION_MARKET_FACTORY=

# Opinion Market Implementation (for proxy pattern)
CONTRACT_OPINION_MARKET_IMPLEMENTATION=

# ------------------------------------------------------------------------------
# Twitter API Integration (OAuth 2.0)
# ------------------------------------------------------------------------------

# Twitter API v2 credentials
# Get from: https://developer.twitter.com/
TWITTER_CLIENT_ID=
TWITTER_CLIENT_SECRET=
TWITTER_BEARER_TOKEN=

# Twitter OAuth 2.0 callback URL
TWITTER_CALLBACK_URL=http://localhost:3000/api/v1/auth/twitter/callback

# Twitter API rate limit buffer (requests per 15min window)
TWITTER_RATE_LIMIT_BUFFER=100

# ------------------------------------------------------------------------------
# Email Service (SendGrid)
# ------------------------------------------------------------------------------

# SendGrid API key
# Get from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=

# From email address (must be verified in SendGrid)
SENDGRID_FROM_EMAIL=no-reply@guesslyfe.com
SENDGRID_FROM_NAME=GuessLyfe

# Email templates (SendGrid dynamic template IDs)
SENDGRID_TEMPLATE_WELCOME=d-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SENDGRID_TEMPLATE_TRADE_CONFIRMATION=d-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SENDGRID_TEMPLATE_MARKET_RESOLVED=d-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SENDGRID_TEMPLATE_PASSWORD_RESET=d-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ------------------------------------------------------------------------------
# Push Notifications (Firebase Cloud Messaging - Optional)
# ------------------------------------------------------------------------------

# FCM Server Key
FCM_SERVER_KEY=

# FCM Project ID
FCM_PROJECT_ID=

# ------------------------------------------------------------------------------
# Error Tracking & Monitoring (Sentry)
# ------------------------------------------------------------------------------

# Sentry DSN (Data Source Name)
# Get from: https://sentry.io/settings/projects/
SENTRY_DSN=

# Enable Sentry error tracking
SENTRY_ENABLED=true

# Sentry environment
SENTRY_ENVIRONMENT=development

# Sentry release version (auto-set from APP_VERSION)
SENTRY_RELEASE=

# Sentry traces sample rate (0.0 to 1.0, 1.0 = 100%)
SENTRY_TRACES_SAMPLE_RATE=0.1

# Sentry profiles sample rate (0.0 to 1.0)
SENTRY_PROFILES_SAMPLE_RATE=1.0

# Enable Sentry debug mode
SENTRY_DEBUG=false

# ------------------------------------------------------------------------------
# Google Cloud Platform (GCP)
# ------------------------------------------------------------------------------

# GCP Project ID
GCP_PROJECT_ID=guesslyfe-production

# GCP Region
GCP_REGION=us-central1

# GCP Service Account Key (path or JSON)
# For local development, download from GCP Console
GCP_SERVICE_ACCOUNT_KEY_PATH=

# GCP Cloud Storage bucket (for file uploads)
GCP_STORAGE_BUCKET=guesslyfe-uploads

# GCP Cloud Logging (enabled in production)
GCP_LOGGING_ENABLED=false

# ------------------------------------------------------------------------------
# Rate Limiting & Security
# ------------------------------------------------------------------------------

# Global throttle TTL (milliseconds, 60000 = 1 minute)
THROTTLE_TTL=60

# Global throttle limit (requests per TTL)
THROTTLE_LIMIT=100

# Authentication endpoints (requests per minute)
RATE_LIMIT_AUTH_TTL=60000
RATE_LIMIT_AUTH_LIMIT=5

# Market creation (requests per hour)
RATE_LIMIT_CREATE_MARKET_TTL=3600000
RATE_LIMIT_CREATE_MARKET_LIMIT=10

# Trading (requests per minute)
RATE_LIMIT_TRADE_TTL=60000
RATE_LIMIT_TRADE_LIMIT=30

# Whitelisted IPs (comma-separated, skip rate limiting)
RATE_LIMIT_WHITELIST_IPS=127.0.0.1,::1

# Enable security headers (helmet)
SECURITY_HEADERS_ENABLED=true

# Content Security Policy
CSP_ENABLED=true

# CSP mode (auto, strict, none)
CSP_MODE=auto

# Enable CSRF protection
CSRF_ENABLED=false

# Trusted proxy IPs (for Cloud Run, load balancers)
TRUSTED_PROXY_IPS=127.0.0.1,::1

# API key for admin endpoints (generate random string)
ADMIN_API_KEY=

# Enable API key authentication
API_KEY_AUTH_ENABLED=false

# Admin credentials (for Bull Board, protected routes)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=change-this-strong-password-in-production

# ------------------------------------------------------------------------------
# File Upload Configuration
# ------------------------------------------------------------------------------

# Maximum file size (bytes, 5MB default)
MAX_FILE_SIZE=5242880

# Allowed file types (comma-separated MIME types)
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp

# Upload destination (local, gcs)
UPLOAD_DESTINATION=./uploads

# Local upload path (relative to project root)
UPLOAD_PATH=./uploads

# ------------------------------------------------------------------------------
# Logging Configuration
# ------------------------------------------------------------------------------

# Log level (error, warn, info, debug)
LOG_LEVEL=debug

# Enable console logging
LOG_TO_CONSOLE=true

# Enable file logging
LOG_TO_FILE=false

# Log file directory
LOG_FILE_DIR=./logs

# Log file rotation settings
LOG_FILE_MAX_SIZE=20m
LOG_FILE_MAX_FILES=14d

# Enable GCP Cloud Logging (production)
LOG_GCP_ENABLED=false

# Log request details
LOG_REQUESTS=true

# ------------------------------------------------------------------------------
# Monitoring & Performance
# ------------------------------------------------------------------------------

# Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# Metrics endpoint path
METRICS_PATH=/metrics

# Enable health check endpoints
HEALTH_CHECK_ENABLED=true

# Health check timeout (milliseconds)
HEALTH_CHECK_TIMEOUT=5000

# Enable performance monitoring
PERFORMANCE_MONITORING_ENABLED=true

# Slow request threshold (milliseconds)
SLOW_REQUEST_THRESHOLD=2000
SLOW_ENDPOINT_THRESHOLD_MS=1000

# ------------------------------------------------------------------------------
# Swagger/OpenAPI Documentation
# ------------------------------------------------------------------------------

# Enable Swagger documentation
SWAGGER_ENABLED=true

# Swagger endpoint path
SWAGGER_PATH=/api/docs

# Swagger title
SWAGGER_TITLE=GuessLyfe API

# Swagger description
SWAGGER_DESCRIPTION=GuessLyfe Prediction Market Platform API

# Swagger version
SWAGGER_VERSION=1.0

# ------------------------------------------------------------------------------
# Cron Jobs & Scheduled Tasks
# ------------------------------------------------------------------------------

# Enable scheduled jobs
CRON_ENABLED=true

# Market resolution check interval (cron expression)
# Default: Every 5 minutes
CRON_MARKET_RESOLUTION=*/5 * * * *

# Notification processing interval
# Default: Every minute
CRON_NOTIFICATION_PROCESSING=* * * * *

# Daily stats aggregation
# Default: Daily at 00:00 UTC
CRON_DAILY_STATS=0 0 * * *

# Cleanup old data
# Default: Weekly on Sunday at 02:00 UTC
CRON_CLEANUP=0 2 * * 0

# ------------------------------------------------------------------------------
# Feature Flags
# ------------------------------------------------------------------------------

# Enable market creation
FEATURE_MARKET_CREATION=true

# Enable trading
FEATURE_TRADING=true

# Enable social features
FEATURE_SOCIAL=true

# Enable notifications
FEATURE_NOTIFICATIONS=true

# Enable referral program
FEATURE_REFERRALS=false

# Enable beta features
BETA_FEATURES_ENABLED=false

# ------------------------------------------------------------------------------
# Development Tools
# ------------------------------------------------------------------------------

# Enable hot reload
HOT_RELOAD=true

# Enable debug mode
DEBUG=false

# Seed database on startup (development only!)
SEED_DATABASE=false

# Mock external services in development
MOCK_EXTERNAL_SERVICES=false

# ------------------------------------------------------------------------------
# Performance & Optimization
# ------------------------------------------------------------------------------

# Enable response compression (gzip)
COMPRESSION_ENABLED=true

# Compression level (0-9, higher = more compression, slower)
COMPRESSION_LEVEL=6

# Enable response caching
CACHE_ENABLED=true

# Cache TTL (seconds)
CACHE_TTL=300

# Enable database query result caching
QUERY_CACHE_ENABLED=false

# Database query cache TTL (seconds)
QUERY_CACHE_TTL=60

# ------------------------------------------------------------------------------
# Alert & Notification Webhooks
# ------------------------------------------------------------------------------

# Slack webhook for notifications
SLACK_WEBHOOK_URL=

# Slack channel for alerts
SLACK_ALERT_CHANNEL=#alerts

# Discord webhook (optional)
DISCORD_WEBHOOK_URL=

# Alert webhook URL (for custom integrations)
ALERT_WEBHOOK_URL=http://localhost:3000/alerts

# ------------------------------------------------------------------------------
# Maintenance Mode
# ------------------------------------------------------------------------------

# Enable maintenance mode (blocks all requests)
MAINTENANCE_MODE=false

# Maintenance mode message
MAINTENANCE_MESSAGE=We are currently performing scheduled maintenance. Please check back soon.

# Maintenance mode allowed IPs (comma-separated)
MAINTENANCE_ALLOWED_IPS=127.0.0.1

# ------------------------------------------------------------------------------
# Localization & Timezone
# ------------------------------------------------------------------------------

# Default locale (en, es, fr, etc.)
DEFAULT_LOCALE=en

# Supported locales (comma-separated)
SUPPORTED_LOCALES=en

# Timezone (for scheduled jobs, timestamps)
TIMEZONE=UTC

# ------------------------------------------------------------------------------
# Business Logic Configuration
# ------------------------------------------------------------------------------

# Minimum market duration (hours)
MIN_MARKET_DURATION_HOURS=1

# Maximum market duration (days)
MAX_MARKET_DURATION_DAYS=365

# Platform fee percentage (0-100)
PLATFORM_FEE_PERCENTAGE=2.5

# Minimum trade amount (in wei)
MIN_TRADE_AMOUNT=1000000000000000

# Maximum trade amount (in wei)
MAX_TRADE_AMOUNT=1000000000000000000000

# Enable market verification
MARKET_VERIFICATION_ENABLED=true

# Creator reputation threshold
CREATOR_REPUTATION_THRESHOLD=100

# ------------------------------------------------------------------------------
# Testing Configuration
# ------------------------------------------------------------------------------

# Test database name (used in test environment)
TEST_DB_DATABASE=guesslyfe_test

# Enable test mode (skips certain validations)
TEST_MODE=false

# ------------------------------------------------------------------------------
# Compliance & Privacy
# ------------------------------------------------------------------------------

# Enable GDPR features
GDPR_ENABLED=false

# Data retention period (days)
DATA_RETENTION_DAYS=365

# Enable user data export
USER_DATA_EXPORT_ENABLED=false

# Enable cookie consent
COOKIE_CONSENT_ENABLED=false

# ==============================================================================
# Notes
# ==============================================================================
#
# Security Best Practices:
# 1. NEVER commit .env file to version control
# 2. Use strong, random values for secrets (JWT_SECRET, API keys)
# 3. Rotate secrets regularly
# 4. Use environment-specific values (dev, staging, prod)
# 5. Store production secrets in GCP Secret Manager
# 6. Use least-privilege principle for API keys
# 7. Enable 2FA for all third-party services
#
# For production deployment:
# 1. Copy this file to .env.production
# 2. Fill in all production values
# 3. Store in GCP Secret Manager using: ./deploy/setup-secrets.sh
# 4. Never store production credentials locally
#
# Generate secure secrets:
#   openssl rand -base64 64
#   node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
#
# ==============================================================================
