# ==============================================================================
# GuessLyfe Backend - Production Environment Template
# ==============================================================================
#
# THIS IS A TEMPLATE - DO NOT USE THESE VALUES IN PRODUCTION!
#
# Instructions:
# 1. Copy this file to .env.production
# 2. Fill in all required values with SECURE production credentials
# 3. Store secrets in GCP Secret Manager using: ./deploy/setup-secrets.sh
# 4. NEVER commit .env.production to version control
#
# ==============================================================================

# ------------------------------------------------------------------------------
# Application
# ------------------------------------------------------------------------------
NODE_ENV=production
APP_VERSION=1.0.0
PORT=8080
API_PREFIX=api/v1
APP_NAME=guesslyfe-backend

# ------------------------------------------------------------------------------
# Frontend URLs
# ------------------------------------------------------------------------------
CORS_ALLOWED_ORIGINS=https://guesslyfe.com,https://www.guesslyfe.com,https://app.guesslyfe.com
CORS_CREDENTIALS=true
FRONTEND_URL=https://app.guesslyfe.com
ADMIN_DASHBOARD_URL=https://admin.guesslyfe.com

# ------------------------------------------------------------------------------
# Database (Cloud SQL)
# ------------------------------------------------------------------------------
# For Cloud Run, use Unix socket connection
DB_HOST=/cloudsql/PROJECT_ID:REGION:guesslyfe-db
DB_PORT=5432
DB_DATABASE=guessly_production
DB_USERNAME=guessly_user
DB_PASSWORD=REPLACE_WITH_SECURE_PASSWORD_FROM_SECRET_MANAGER
DB_POOL_MIN=5
DB_POOL_MAX=25
DB_LOGGING=false
DB_SYNCHRONIZE=false
DB_SSL_MODE=require
LOG_QUERIES=false

# ------------------------------------------------------------------------------
# Redis (Memorystore)
# ------------------------------------------------------------------------------
REDIS_HOST=10.x.x.x
REDIS_PORT=6379
REDIS_PASSWORD=REPLACE_WITH_REDIS_PASSWORD
REDIS_DB=0
REDIS_TIMEOUT=5000
REDIS_PREFIX=guesslyfe:prod:
REDIS_CACHE_TTL=3600

# ------------------------------------------------------------------------------
# Bull Queue
# ------------------------------------------------------------------------------
BULL_REDIS_HOST=10.x.x.x
BULL_REDIS_PORT=6379
BULL_REDIS_DB=1
BULL_REDIS_PASSWORD=REPLACE_WITH_REDIS_PASSWORD
QUEUE_NOTIFICATION_CONCURRENCY=10
QUEUE_BLOCKCHAIN_CONCURRENCY=5
QUEUE_EMAIL_CONCURRENCY=10
QUEUE_MAX_RETRY_ATTEMPTS=3
QUEUE_RETRY_BACKOFF_MS=5000
QUEUE_MONITOR_ENABLED=false
QUEUE_MONITOR_PATH=/admin/queues

# ------------------------------------------------------------------------------
# JWT Authentication
# CRITICAL: Generate secure random secrets!
# Use: openssl rand -base64 64
# ------------------------------------------------------------------------------
JWT_SECRET=REPLACE_WITH_SECURE_RANDOM_64_BYTE_SECRET
JWT_EXPIRATION=1h
JWT_REFRESH_SECRET=REPLACE_WITH_DIFFERENT_SECURE_RANDOM_64_BYTE_SECRET
JWT_REFRESH_EXPIRATION=7d
JWT_ISSUER=guesslyfe.com
JWT_AUDIENCE=guesslyfe-api

# ------------------------------------------------------------------------------
# Blockchain (Base Mainnet)
# ------------------------------------------------------------------------------
BLOCKCHAIN_NETWORK=baseMainnet
BLOCKCHAIN_RPC_URL=https://base-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_API_KEY
BLOCKCHAIN_RPC_URL_FALLBACK=https://mainnet.base.org
BLOCKCHAIN_CHAIN_ID=8453
BLOCKCHAIN_RPC_TIMEOUT=30000
BLOCKCHAIN_PROVIDER_PRIVATE_KEY=REPLACE_WITH_PRIVATE_KEY_FROM_SECRET_MANAGER
BLOCKCHAIN_GAS_LIMIT=500000
BLOCKCHAIN_GAS_PRICE_MULTIPLIER=1.1
BLOCKCHAIN_CONFIRMATIONS=2
BLOCKCHAIN_INDEXING_ENABLED=true
BLOCKCHAIN_INDEXING_START_BLOCK=0

# ------------------------------------------------------------------------------
# Smart Contracts (Base Mainnet - Deploy First!)
# ------------------------------------------------------------------------------
CONTRACT_USDC=REPLACE_WITH_MAINNET_USDC_ADDRESS
CONTRACT_FEE_COLLECTOR=REPLACE_WITH_DEPLOYED_FEE_COLLECTOR_ADDRESS
CONTRACT_CREATOR_SHARE_FACTORY=REPLACE_WITH_DEPLOYED_FACTORY_ADDRESS
CONTRACT_OPINION_MARKET=REPLACE_WITH_DEPLOYED_MARKET_ADDRESS
CONTRACT_OPINION_MARKET_FACTORY=
CONTRACT_OPINION_MARKET_IMPLEMENTATION=

# ------------------------------------------------------------------------------
# Twitter API
# ------------------------------------------------------------------------------
TWITTER_CLIENT_ID=REPLACE_WITH_TWITTER_CLIENT_ID
TWITTER_CLIENT_SECRET=REPLACE_WITH_TWITTER_CLIENT_SECRET
TWITTER_BEARER_TOKEN=REPLACE_WITH_TWITTER_BEARER_TOKEN
TWITTER_CALLBACK_URL=https://api.guesslyfe.com/api/v1/auth/twitter/callback
TWITTER_RATE_LIMIT_BUFFER=100

# ------------------------------------------------------------------------------
# Email (SendGrid)
# ------------------------------------------------------------------------------
SENDGRID_API_KEY=REPLACE_WITH_SENDGRID_API_KEY
SENDGRID_FROM_EMAIL=noreply@guesslyfe.com
SENDGRID_FROM_NAME=GuessLyfe
SENDGRID_TEMPLATE_WELCOME=REPLACE_WITH_TEMPLATE_ID
SENDGRID_TEMPLATE_TRADE_CONFIRMATION=REPLACE_WITH_TEMPLATE_ID
SENDGRID_TEMPLATE_MARKET_RESOLVED=REPLACE_WITH_TEMPLATE_ID
SENDGRID_TEMPLATE_PASSWORD_RESET=REPLACE_WITH_TEMPLATE_ID

# ------------------------------------------------------------------------------
# Firebase
# ------------------------------------------------------------------------------
FCM_SERVER_KEY=REPLACE_WITH_FCM_SERVER_KEY
FCM_PROJECT_ID=guesslyfe-production

# ------------------------------------------------------------------------------
# Error Tracking (Sentry)
# ------------------------------------------------------------------------------
SENTRY_DSN=REPLACE_WITH_SENTRY_DSN
SENTRY_ENABLED=true
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_DEBUG=false

# ------------------------------------------------------------------------------
# GCP
# ------------------------------------------------------------------------------
GCP_PROJECT_ID=guesslyfe-production
GCP_REGION=us-central1
GCP_SERVICE_ACCOUNT_KEY_PATH=
GCP_STORAGE_BUCKET=guesslyfe-production-uploads
GCP_LOGGING_ENABLED=true

# ------------------------------------------------------------------------------
# Rate Limiting (Strict in production)
# ------------------------------------------------------------------------------
THROTTLE_TTL=60
THROTTLE_LIMIT=100
RATE_LIMIT_AUTH_TTL=60000
RATE_LIMIT_AUTH_LIMIT=5
RATE_LIMIT_CREATE_MARKET_TTL=3600000
RATE_LIMIT_CREATE_MARKET_LIMIT=10
RATE_LIMIT_TRADE_TTL=60000
RATE_LIMIT_TRADE_LIMIT=30
RATE_LIMIT_WHITELIST_IPS=

# ------------------------------------------------------------------------------
# Security (Maximum security in production)
# ------------------------------------------------------------------------------
SECURITY_HEADERS_ENABLED=true
CSP_ENABLED=true
CSP_MODE=strict
CSRF_ENABLED=true
TRUSTED_PROXY_IPS=169.254.0.0/16
ADMIN_API_KEY=REPLACE_WITH_SECURE_RANDOM_API_KEY
API_KEY_AUTH_ENABLED=true
ADMIN_USERNAME=REPLACE_WITH_ADMIN_USERNAME
ADMIN_PASSWORD=REPLACE_WITH_SECURE_ADMIN_PASSWORD

# ------------------------------------------------------------------------------
# File Upload
# ------------------------------------------------------------------------------
MAX_FILE_SIZE=5242880
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp
UPLOAD_DESTINATION=gcs
UPLOAD_PATH=uploads

# ------------------------------------------------------------------------------
# Logging (Structured JSON for production)
# ------------------------------------------------------------------------------
LOG_LEVEL=info
LOG_TO_CONSOLE=true
LOG_TO_FILE=false
LOG_FILE_DIR=./logs
LOG_FILE_MAX_SIZE=20m
LOG_FILE_MAX_FILES=14d
LOG_GCP_ENABLED=true
LOG_REQUESTS=true

# ------------------------------------------------------------------------------
# Monitoring
# ------------------------------------------------------------------------------
METRICS_ENABLED=true
METRICS_PATH=/metrics
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT=5000
PERFORMANCE_MONITORING_ENABLED=true
SLOW_REQUEST_THRESHOLD=2000
SLOW_ENDPOINT_THRESHOLD_MS=1000

# ------------------------------------------------------------------------------
# Swagger (DISABLED in production for security)
# ------------------------------------------------------------------------------
SWAGGER_ENABLED=false
SWAGGER_PATH=/api/docs
SWAGGER_TITLE=GuessLyfe API
SWAGGER_DESCRIPTION=GuessLyfe Prediction Market Platform API
SWAGGER_VERSION=1.0

# ------------------------------------------------------------------------------
# Cron Jobs (Enabled in production)
# ------------------------------------------------------------------------------
CRON_ENABLED=true
CRON_MARKET_RESOLUTION=*/5 * * * *
CRON_NOTIFICATION_PROCESSING=* * * * *
CRON_DAILY_STATS=0 0 * * *
CRON_CLEANUP=0 2 * * 0

# ------------------------------------------------------------------------------
# Feature Flags
# ------------------------------------------------------------------------------
FEATURE_MARKET_CREATION=true
FEATURE_TRADING=true
FEATURE_SOCIAL=true
FEATURE_NOTIFICATIONS=true
FEATURE_REFERRALS=false
BETA_FEATURES_ENABLED=false

# ------------------------------------------------------------------------------
# Development Tools (DISABLED in production)
# ------------------------------------------------------------------------------
HOT_RELOAD=false
DEBUG=false
SEED_DATABASE=false
MOCK_EXTERNAL_SERVICES=false

# ------------------------------------------------------------------------------
# Performance (Optimized for production)
# ------------------------------------------------------------------------------
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6
CACHE_ENABLED=true
CACHE_TTL=300
QUERY_CACHE_ENABLED=true
QUERY_CACHE_TTL=60

# ------------------------------------------------------------------------------
# Alerts (Production monitoring)
# ------------------------------------------------------------------------------
SLACK_WEBHOOK_URL=REPLACE_WITH_SLACK_WEBHOOK_URL
SLACK_ALERT_CHANNEL=#production-alerts
DISCORD_WEBHOOK_URL=
ALERT_WEBHOOK_URL=https://api.guesslyfe.com/alerts

# ------------------------------------------------------------------------------
# Maintenance
# ------------------------------------------------------------------------------
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=We are currently performing scheduled maintenance. Please check back soon.
MAINTENANCE_ALLOWED_IPS=

# ------------------------------------------------------------------------------
# Localization
# ------------------------------------------------------------------------------
DEFAULT_LOCALE=en
SUPPORTED_LOCALES=en
TIMEZONE=UTC

# ------------------------------------------------------------------------------
# Business Logic
# ------------------------------------------------------------------------------
MIN_MARKET_DURATION_HOURS=1
MAX_MARKET_DURATION_DAYS=365
PLATFORM_FEE_PERCENTAGE=2.5
MIN_TRADE_AMOUNT=1000000000000000
MAX_TRADE_AMOUNT=1000000000000000000000
MARKET_VERIFICATION_ENABLED=true
CREATOR_REPUTATION_THRESHOLD=100

# ------------------------------------------------------------------------------
# Testing (DISABLED in production)
# ------------------------------------------------------------------------------
TEST_DB_DATABASE=guesslyfe_test
TEST_MODE=false

# ------------------------------------------------------------------------------
# Compliance
# ------------------------------------------------------------------------------
GDPR_ENABLED=true
DATA_RETENTION_DAYS=365
USER_DATA_EXPORT_ENABLED=true
COOKIE_CONSENT_ENABLED=true

# ==============================================================================
# PRODUCTION CHECKLIST
# ==============================================================================
#
# Before deploying to production, ensure:
#
# [ ] All secrets are unique, random, and secure (64+ characters)
# [ ] Database credentials are from Secret Manager
# [ ] JWT secrets are different from development
# [ ] Private keys are secure and backed up
# [ ] API keys are production-level (not test/sandbox)
# [ ] CORS origins are production domains only
# [ ] Rate limiting is strict
# [ ] Security headers are enabled
# [ ] Swagger is disabled
# [ ] Debug mode is off
# [ ] Hot reload is disabled
# [ ] Logging is set to 'info' or 'warn'
# [ ] GCP Cloud Logging is enabled
# [ ] Sentry is configured with production DSN
# [ ] Alerts are configured (Slack/PagerDuty)
# [ ] Maintenance mode works
# [ ] Backups are configured and tested
# [ ] SSL certificates are valid
# [ ] All third-party services are production-ready
# [ ] Load testing completed
# [ ] Security audit completed
#
# ==============================================================================
